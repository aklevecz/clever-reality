(this["webpackJsonporb-stream"]=this["webpackJsonporb-stream"]||[]).push([[0],{18:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);t.default="\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    //gl_Position = vec4(position, 1.0);\n}"},23:function(e,t,n){"use strict";n.r(t);t.default="\nvarying vec2 vUv;\n\nuniform sampler2D videoTexture;\nuniform vec2 resolution;\n\nvoid main()\n{\n  vec2 uv = vec2(0.5) + vUv * resolution.xy - resolution.xy*0.5;\n  vec4 color = vec4(0.);\n  if (uv.x>=0.0 && uv.y>=0.0 && uv.x<1.0 && uv.y<1.0) color = vec4(texture2D(videoTexture, uv).rgb, 1.0);\n  gl_FragColor = color;\n}\n"},24:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(2),i=n.n(o),a=n(9),c=n.n(a),s=(n(18),n(4)),u=n(0),d=(n(19),n(10)),l=n(6),v=n.n(l),f=n(11),h=n(7),w=n.n(h),m=n.p+"static/media/fire.5b252a8b.mp4",b=(n(21),n(12)),p=function(e){return Math.floor(Math.random()*e)},j=0,g=20,x=50,y=new u.t(1,30,30),O=new u.q,k=void 0,E=new b.a,M=new u.p,S=new u.w(9999,9999),z=[],P=[],C=function(e){var t=n(22).default,r=n(23).default,o=new u.y(e),i=new u.n(10,10),a=new u.r({uniforms:{resolution:{value:new u.w(1,16/9)},videoTexture:{value:o}},transparent:!0,vertexShader:t,fragmentShader:r,depthWrite:!0,depthTest:!0}),c=new u.h(i,a);c.position.z=-10,c.position.y=.5,O.add(c);var s=new u.b(10,6.5,2),d=new u.j({color:"black"}),l=new u.h(s,d);l.castShadow=!0,l.position.z=-11.1,P.push(l),O.add(l)},L=100,R=function(e){for(var t=e.video,n=void 0===t?document.querySelector("#master"):t,r=e.color,o=e.n,i=void 0===o?1:o,a=0;a<i;a++){var c=new u.c("rgb(".concat(p(255)+20,", ").concat(p(255)+20,", ").concat(p(255)+20,")")),s=y,d=new u.i({color:r||c}),l=new u.h(s,d),v=2*Math.random()*L-100,f=Math.random()*L,h=2*Math.random()*L-100;l.position.set(v,f,h),l.rotation.y=1.5*Math.PI,l.castShadow=!0,n&&(l.vId=n.id.replace("remote-video-","")),O.add(l),z.push(l)}};function A(e){var t=e.changeVolume,n=Object(o.useRef)();return Object(o.useEffect)((function(){var e=n.current,r=e.getContext("2d"),o=e.width,i=e.height;r.rect(0,0,o,i),r.fillStyle="#00ffb1",r.fill();var a=!0;e.onmousedown=function(e){a=!1},e.ontouchstart=function(){return a=!1};var c=function(n){if(!a){var r=e.getBoundingClientRect(),o=e.getContext("2d"),c={x:(n.touches?n.touches[0].clientX:n.clientX)-r.left};o.clearRect(0,0,o.canvas.width,o.canvas.height),o.beginPath(),o.rect(0,0,c.x,i),o.fill(),t(c.x/o.canvas.width)}};e.onmousemove=c,e.ontouchmove=c,document.onmouseup=function(){return a=!0}}),[]),Object(r.jsx)("div",{id:"volume",children:Object(r.jsx)("canvas",{ref:n})})}function X(e){var t=e.videoRef,n=e.isPlaying,o=e.isMuted,i=e.toggleMute;return Object(r.jsxs)("div",{id:"controls-container",children:[Object(r.jsx)("div",{onClick:function(){var e=t.current;e.currentTime=e.seekable.end(0)},children:"Go To Live"}),Object(r.jsx)("div",{onClick:function(){var e=t.current;console.log(n),n?e.pause():e.play()},children:n?"Pause":"Play"}),Object(r.jsx)("div",{onClick:i,children:o?"Unmute":"Mute"}),Object(r.jsx)("div",{onClick:R,children:"Orb"}),"iPhone"!==navigator.platform&&Object(r.jsx)(A,{changeVolume:function(e){return t.current.volume=(r=0,(n=e)>(o=1)?o:n<r?r:n);var n,r,o}})]})}var B="https://ice.raptor.pizza/hls/meiosis.m3u8";function F(e){var t=e.createScreen,n=(e.phase,e.videoRef),i=e.test,a=void 0!==i&&i,c=Object(o.useState)(!a),u=Object(s.a)(c,2),d=u[0],l=u[1],h=Object(o.useState)(0),b=Object(s.a)(h,2),p=b[0],j=b[1],g=Object(o.useState)(!1),x=Object(s.a)(g,2),y=x[0],O=x[1],k=Object(o.useState)(!0),E=Object(s.a)(k,2),M=E[0],S=E[1],z=Object(o.useCallback)(Object(f.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.current,e.next=3,fetch(B).then((function(e){return e})).then((function(e){if(404===e.status)return!1;l(!1);var n=B;if(w.a.isSupported()){var r=new w.a;r.loadSource(n),r.attachMedia(t)}else t.src=n}));case 3:case"end":return e.stop()}}),e)}))),[n]);Object(o.useEffect)((function(){z()}),[z]);var P=Object(o.useCallback)((function(){return j(p+1)}),[p]);Object(o.useEffect)((function(){if(d)return p>15?(j(0),z()):void setTimeout(P,1e3)}),[z,P,p,d]),Object(o.useEffect)((function(){n.current.src=m,t(n.current),n.current.onplay=function(){return O(!0)},n.current.onpause=function(){return O(!1)}}),[]),Object(o.useEffect)((function(){var e=n.current;e.muted=!!M}),[M,n]);return Object(r.jsxs)("div",{children:[Object(r.jsx)("video",{id:"artist-stream",className:"video-js",crossOrigin:"true",ref:n,playsInline:!0,autoPlay:!0,loop:!0,controls:!0,muted:!0}),Object(r.jsx)(X,{videoRef:n,isPlaying:y,isMuted:M,toggleMute:function(e){console.log(e),S(!M)}})]})}var I=n(8);function T(e){var t=e.phase,n=Object(o.useState)(),i=Object(s.a)(n,2),a=i[0],c=i[1],u=Object(o.useRef)();return Object(o.useEffect)((function(){var e=u.current.getBoundingClientRect();c({marginLeft:-e.width/2+"px",marginTop:-e.height/2+"px"})}),[]),Object(o.useEffect)((function(){1===t&&c(Object(I.a)(Object(I.a)({},a),{},{opacity:0}))}),[t]),Object(r.jsx)("div",{ref:u,style:a,id:"press-start",children:"Press"})}function Y(){var e=Object(o.useState)(0),t=Object(s.a)(e,2),n=t[0],i=t[1],a=Object(o.useRef)(void 0),c=Object(o.useRef)(void 0);return Object(o.useEffect)((function(){}),[n]),Object(o.useEffect)((function(){if(void 0!==a.current){var e,t=new u.l(75,window.innerWidth/window.innerHeight,.1,1e3),n=j,r=g,o=x;t.position.set(n,r,o),t.lookAt(0,0,0);var s=!1,l=!1,v=!1,f=!1,h=new u.x,w=new u.x,m=new u.z;m.setClearColor(new u.c(1,1,1)),m.setSize(window.innerWidth,window.innerHeight),m.setPixelRatio(window.devicePixelRatio),m.shadowMap.enabled=!0,m.shadowMap.type=u.k,a.current.appendChild(m.domElement);var b,p,y=function(){var e=new u.t(1,20,20),t=new u.i({color:new u.c(1,0,0),transparent:!0}),n=new u.h(e,t);n.name="start-button";var r={x:j,y:g-2,z:x-5,widthSegments:1,heightSegments:1};if(n.position.set(r.x,r.y,r.z),O.add(n),k){var o=k.addFolder("Start Button");o.add(r,"x",-20,20,.1).onChange((function(e){return n.position.x=e})),o.add(r,"y",-20,20,.1).onChange((function(e){return n.position.y=e})),o.add(r,"z",r.z-20,r.z+20,.1).onChange((function(e){return n.position.z=e}))}return n}();!function(){var e=new u.m(200,200,100,100);e.rotateX(-Math.PI/2),e=e.toNonIndexed();var t=new u.j({color:"white"}),n=new u.h(e,t);n.position.y=-2,n.receiveShadow=!0,n.castShadow=!0,n.name="floor",O.add(n)}(),function(){var e=new u.d(16777215,1.9,100);e.position.set(0,70,30),e.target.position.set(0,0,-10),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.near=.5,e.shadow.camera.far=500,e.shadow.camera.left=-50,e.shadow.camera.right=50,e.shadow.camera.top=50,e.shadow.camera.bottom=-50,O.add(e),O.add(e.target)}(),a.current.addEventListener("touchstart",G,!0),a.current.addEventListener("click",G,!0);var C=!1,L=!1;document.addEventListener("touchstart",(function(e){var t=function(e){return e.touches||e.originalEvent.touches}(e)[0];A=t.clientX,X=t.clientY,!0,B.set(e.touches[0].clientX,e.touches[0].clientY)}),!1),document.addEventListener("touchend",(function(e){s=!1,l=!1,!1}),!1),document.addEventListener("touchmove",(function(e){if(F.set(e.touches[0].clientX,e.touches[0].clientY),I.subVectors(F,B),B.copy(F),T+=2*Math.PI*I.y/m.domElement.height*.3,Y+=2*Math.PI*I.x/m.domElement.width*.5,!A||!X)return;var t=e.touches[0].clientX,n=e.touches[0].clientY,r=A-t,o=X-n;Math.abs(r)>Math.abs(o)||(o>0?l=!0:s=!0);A=null,X=null}),!1);var A=null,X=null,B=new u.w,F=new u.w,I=new u.w,T=0,Y=1*Math.PI/180,q={minPolarAngle:0};q.maxPolarAngle=Math.PI;var W,N,U,H,V=new u.e(0,0,0,"YXZ"),D=new u.a,_=!0,J=new u.o;!function n(){W=requestAnimationFrame(n),T===U&&Y===H||C&&(U=T,H=Y,V.set(T,Y,0,"YXZ"),J.setFromEuler(V),t.quaternion.copy(J));var r=performance.now();if(e&&e.isLocked){w.z=Number(s)-Number(l),w.x=Number(f)-Number(v),w.normalize();var o=(r-N)/1e3;h.x-=10*h.x*o,h.z-=10*h.z*o;var i=e.getObject(),a=new u.x;a.copy(i.position),h.y-=9.8*100*o,(s||l)&&(h.z-=400*w.z*o),(v||f)&&(h.x-=400*w.x*o),e.moveRight(-h.x*o),e.moveForward(-h.z*o);var c=new u.s(i.position,2);if(P.length>0){var d=P[0];d.geometry.computeBoundingBox(),D.copy(d.geometry.boundingBox).applyMatrix4(d.matrixWorld),c.intersectsBox(D)&&(h.y=Math.max(0,h.y),0===e.getObject().position.y&&i.position.copy(a),_=!0)}e.getObject().position.y+=h.y*o,e.getObject().position.y<0&&(h.y=0,e.getObject().position.y=0,_=!0)}N=r,b&&b.getByteFrequencyData(p);for(var j=0;j<z.length;j++){z[j].rotation.y+=.01;var g=Math.sin(.001*r+j);if(z[j].scale.set(g,g,g),b){var x=p[j%256]/100;z[j].scale.set(x,x,x)}}m.render(O,t),E.update()}();var Z=function(){t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",Z,!1),function(){cancelAnimationFrame(W),window.removeEventListener("resize",Z,!1)}}function G(n){if(function(e){var t={x:0,y:0};e instanceof TouchEvent?(t.x=e.touches[0].clientX,t.y=e.touches[0].clientY):(t.x=e.clientX,t.y=e.clientY),S.x=t.x/window.innerWidth*2-1,S.y=-t.y/window.innerHeight*2+1}(n),M.setFromCamera(S,t),M.intersectObjects([y]).length>0&&(function(){if("iPhone"!==navigator.platform&&"Android"!==navigator.platform){var e=new(window.AudioContext||window.webkitAudioContext);b=e.createAnalyser();var t=e.createMediaElementSource(c.current);t.connect(b),t.connect(e.destination),b.fftSize=512;var n=b.frequencyBinCount;p=new Uint8Array(n)}}(),c.current.play(),!L)){L=!0;var r,o=performance.now(),w=y.material.color;!function n(){var c=.001*(performance.now()-o);if(y.material.color.set(w.lerp(new u.c(0,0,1),c)),y.material.opacity=function(e,t,n){return e*(n-t)+t}(c-1,1,0),i(1),c>2){C=!0,e=new d.a(t,a.current),a.current.addEventListener("click",(function(){return e.lock()})),O.add(e.getObject()),document.addEventListener("keydown",(function(e){switch(e.key){case"w":s=!0;break;case"a":v=!0;break;case"s":l=!0;break;case"d":f=!0;break;case" ":_&&(h.y+=200),_=!1}}),!1),document.addEventListener("keyup",(function(e){switch(e.key){case"w":s=!1;break;case"a":v=!1;break;case"s":l=!1;break;case"d":f=!1}}),!1);try{e.lock()}catch(m){e.isLocked=!0}return R({n:1e3}),cancelAnimationFrame(r)}r=requestAnimationFrame(n)}()}a.current.removeEventListener("touchstart",G,!0),a.current.removeEventListener("click",G,!0)}}),[]),Object(r.jsxs)("div",{style:{width:"100%",height:"100%"},ref:a,children:[Object(r.jsx)(T,{phase:n}),Object(r.jsx)(F,{createScreen:C,phase:n,videoRef:c,test:false})]})}var q=function(){return Object(r.jsx)("div",{children:Object(r.jsx)(Y,{})})};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(q,{})}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.f8a60fa5.chunk.js.map