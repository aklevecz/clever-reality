{"version":3,"sources":["shaders/screen-vertex.js","shaders/screen-fragment.js","fire.mp4","ThreeFuncs.js","Volume.js","StreamControls.js","ArtistStream.js","PressStart.js","ThreeWorld.js","App.js","index.js"],"names":["vertexShader","fshader","randomI","max","Math","floor","random","CAMERA_START","orbGeoRef","THREE","scene","stats","Stats","ray","mouse","orbs","collisionObjects","createScreen","video","require","default","fragmentShader","videoTexture","geometry","material","uniforms","resolution","value","transparent","depthWrite","depthTest","mesh","position","z","y","add","backGeo","backMaterial","color","backMesh","castShadow","push","r","createOrb","document","querySelector","n","i","rColor","x","set","rotation","PI","vId","id","replace","Volume","changeVolume","canvasRef","useRef","useEffect","canvas","current","ctx","getContext","w","width","h","height","rect","fillStyle","fill","up","onmousedown","e","ontouchstart","changeBar","getBoundingClientRect","coords","touches","clientX","left","clearRect","beginPath","onmousemove","ontouchmove","onmouseup","ref","StreamControls","videoRef","isPlaying","isMuted","toggleMute","setupAudioContext","onClick","currentTime","seekable","end","console","log","pause","play","navigator","platform","volume","min","val","url","ArtistStream","phase","test","useState","loading","setLoading","retryCounter","setRetryCounter","setIsPlaying","setIsMuted","initStream","useCallback","a","fetch","then","d","status","source","Hls","isSupported","hls","loadSource","attachMedia","src","incrementCounter","setTimeout","fire","onplay","onpause","muted","className","crossOrigin","playsInline","autoPlay","loop","controls","PressStart","styles","setStyles","marginLeft","marginTop","style","opacity","analyser","dataArray","ThreeWorld","setPhase","worldContainerRef","undefined","camera","window","innerWidth","innerHeight","lookAt","moveForward","moveBackward","moveLeft","moveRight","velocity","direction","renderer","setClearColor","setSize","setPixelRatio","devicePixelRatio","shadowMap","enabled","type","appendChild","domElement","startButtonObject","name","buttonState","widthSegments","heightSegments","startButton","rotateX","toNonIndexed","receiveShadow","createFloor","light","target","shadow","mapSize","near","far","right","top","bottom","createLight","addEventListener","checkClick","started","clickAnimationRunning","evt","firstTouch","originalEvent","getTouches","xDown","yDown","clientY","rotateStart","rotateEnd","rotateDelta","subVectors","copy","phi","theta","xUp","yUp","xDiff","yDiff","abs","scope","maxPolarAngle","frame","prevTime","previousPhi","previousTheta","euler","bbox","canJump","orientation","animate","requestAnimationFrame","setFromEuler","quaternion","time","performance","now","isLocked","Number","normalize","delta","controlObject","getObject","oldPosition","sphere","length","object","computeBoundingBox","boundingBox","applyMatrix4","matrixWorld","intersectsBox","getByteFrequencyData","wave","sin","scale","render","update","onWindowResize","aspect","updateProjectionMatrix","cancelAnimationFrame","removeEventListener","TouchEvent","mouseVector","setFromCamera","intersectObjects","start","currentColor","buttonAnimation","lerp","b","PointerLockControls","lock","key","err","audioCtx","AudioContext","webkitAudioContext","createAnalyser","createMediaElementSource","connect","destination","fftSize","bufferLength","frequencyBinCount","Uint8Array","App","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a90d0066.chunk.js","sourcesContent":["const vertexShader = `\r\nvarying vec2 vUv;\r\nvoid main() {\r\n    vUv = uv;\r\n\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n    //gl_Position = vec4(position, 1.0);\r\n}`;\r\n\r\nexport default vertexShader;\r\n","const fragmentShader = `\r\nuniform vec4 resolution;\r\nuniform sampler2D videoTexture;\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n    vec2 newUV = (vUv - vec2(0.5)) * resolution.xy + vec2(.5);\r\n    vec4 tex = texture2D(videoTexture, newUV);\r\n    gl_FragColor = tex;\r\n}`;\r\n\r\nconst fshader = `\r\nvarying vec2 vUv;\r\n\r\nuniform sampler2D videoTexture;\r\nuniform vec2 resolution;\r\n\r\nvoid main()\r\n{\r\n  vec2 uv = vec2(0.5) + vUv * resolution.xy - resolution.xy*0.5;\r\n  vec4 color = vec4(0.);\r\n  if (uv.x>=0.0 && uv.y>=0.0 && uv.x<1.0 && uv.y<1.0) color = vec4(texture2D(videoTexture, uv).rgb, 1.0);\r\n  gl_FragColor = color;\r\n}\r\n`;\r\n\r\nexport default fshader;\r\n","export default __webpack_public_path__ + \"static/media/fire.5b252a8b.mp4\";","import * as THREE from \"three\";\r\nimport Stats from \"three/examples/jsm/libs/stats.module.js\";\r\n\r\nconst randomI = (max) => Math.floor(Math.random() * max);\r\n\r\nexport const lerp = (x, a, b) => {\r\n  return x * (b - a) + a;\r\n};\r\n\r\nconst randomColor = () =>\r\n  new THREE.Color(\r\n    `rgb(${randomI(255) + 20}, ${randomI(255) + 20}, ${randomI(255) + 20})`\r\n  );\r\nconst gVideo = () => document.querySelector(\"#master\");\r\n\r\nexport const CAMERA_START = { x: 0, y: 20, z: 50 };\r\n\r\nconst orbGeoRef = new THREE.SphereGeometry(1, 30, 30);\r\nexport const scene = new THREE.Scene();\r\nexport const stats = new Stats();\r\nexport const ray = new THREE.Raycaster();\r\nexport const mouse = new THREE.Vector2(9999, 9999);\r\nexport var orbs = [];\r\nexport var collisionObjects = [];\r\n\r\nexport const startButton = () => {\r\n  const geometry = new THREE.SphereGeometry(1, 20, 20);\r\n  const material = new THREE.MeshPhysicalMaterial({\r\n    color: new THREE.Color(1, 0, 0),\r\n    transparent: true,\r\n  });\r\n  const mesh = new THREE.Mesh(geometry, material);\r\n  mesh.name = \"start-button\";\r\n  const { x, y, z } = CAMERA_START;\r\n  const buttonState = {\r\n    x,\r\n    y: y - 2,\r\n    z: z - 5,\r\n    widthSegments: 1,\r\n    heightSegments: 1,\r\n  };\r\n  mesh.position.set(buttonState.x, buttonState.y, buttonState.z);\r\n  scene.add(mesh);\r\n  // if (gui) {\r\n  //   const folder = gui.addFolder(\"Start Button\");\r\n  //   folder\r\n  //     .add(buttonState, \"x\", -20, 20, 0.1)\r\n  //     .onChange((e) => (mesh.position.x = e));\r\n  //   folder\r\n  //     .add(buttonState, \"y\", -20, 20, 0.1)\r\n  //     .onChange((e) => (mesh.position.y = e));\r\n  //   folder\r\n  //     .add(buttonState, \"z\", buttonState.z - 20, buttonState.z + 20, 0.1)\r\n  //     .onChange((e) => (mesh.position.z = e));\r\n  // }\r\n  return mesh;\r\n};\r\n\r\nexport const createFloor = () => {\r\n  var geometry = new THREE.PlaneBufferGeometry(200, 200, 100, 100);\r\n  geometry.rotateX(-Math.PI / 2);\r\n  geometry = geometry.toNonIndexed();\r\n  const material = new THREE.MeshStandardMaterial({ color: \"white\" });\r\n  const mesh = new THREE.Mesh(geometry, material);\r\n  mesh.position.y = -2;\r\n  mesh.receiveShadow = true;\r\n  mesh.castShadow = true;\r\n  mesh.name = \"floor\";\r\n  scene.add(mesh);\r\n};\r\n\r\nexport const createLight = () => {\r\n  const color = 0xffffff;\r\n  const intensity = 1.9;\r\n  const light = new THREE.DirectionalLight(color, intensity, 100);\r\n  light.position.set(0, 70, 30);\r\n  light.target.position.set(0, 0, -10);\r\n  light.castShadow = true;\r\n  light.shadow.mapSize.width = 2048;\r\n  light.shadow.mapSize.height = 2048;\r\n  light.shadow.camera.near = 0.5;\r\n  light.shadow.camera.far = 500;\r\n  const shadowF = 50;\r\n  light.shadow.camera.left = -shadowF;\r\n  light.shadow.camera.right = shadowF;\r\n  light.shadow.camera.top = shadowF;\r\n  light.shadow.camera.bottom = -shadowF;\r\n  scene.add(light);\r\n  scene.add(light.target);\r\n};\r\n\r\nexport const createScreen = (video) => {\r\n  const vertexShader = require(\"./shaders/screen-vertex.js\").default;\r\n  const fragmentShader = require(\"./shaders/screen-fragment.js\").default;\r\n  const videoTexture = new THREE.VideoTexture(video);\r\n  const geometry = new THREE.PlaneGeometry(10, 10);\r\n  const material = new THREE.ShaderMaterial({\r\n    uniforms: {\r\n      resolution: { value: new THREE.Vector2(1, 16 / 9) },\r\n      videoTexture: { value: videoTexture },\r\n    },\r\n    transparent: true,\r\n    vertexShader,\r\n    fragmentShader,\r\n    depthWrite: true,\r\n    depthTest: true,\r\n  });\r\n  const mesh = new THREE.Mesh(geometry, material);\r\n  mesh.position.z = -10;\r\n  mesh.position.y = 0.5;\r\n  scene.add(mesh);\r\n\r\n  const backGeo = new THREE.BoxBufferGeometry(10, 6.5, 2);\r\n  const backMaterial = new THREE.MeshStandardMaterial({ color: \"black\" });\r\n  const backMesh = new THREE.Mesh(backGeo, backMaterial);\r\n  backMesh.castShadow = true;\r\n  backMesh.position.z = -11.1;\r\n  collisionObjects.push(backMesh);\r\n  scene.add(backMesh);\r\n};\r\n\r\nconst r = 100;\r\nexport const createOrb = ({ video = gVideo(), color, n = 1 }) => {\r\n  for (var i = 0; i < n; i++) {\r\n    const rColor = randomColor();\r\n    const geometry = orbGeoRef;\r\n    // const texture = new THREE.VideoTexture(video);\r\n    const material = new THREE.MeshPhysicalMaterial({\r\n      // map: texture,\r\n      color: color ? color : rColor,\r\n      // transparent: true,\r\n      // opacity: 0.7,\r\n    });\r\n    const mesh = new THREE.Mesh(geometry, material);\r\n\r\n    const x = Math.random() * 2 * r - (2 * r) / 2;\r\n    const y = Math.random() * r;\r\n    const z = Math.random() * 2 * r - (2 * r) / 2;\r\n    // const z = Math.random() * r * 3;\r\n    mesh.position.set(x, y, z);\r\n    mesh.rotation.y = Math.PI * 1.5;\r\n    mesh.castShadow = true;\r\n    if (video) mesh.vId = video.id.replace(\"remote-video-\", \"\");\r\n    scene.add(mesh);\r\n    orbs.push(mesh);\r\n  }\r\n};\r\n\r\nexport const removeOrb = (event) => {\r\n  const vId = event.stream.streamId;\r\n  orbs = orbs.filter((o) => o.vId !== vId);\r\n  for (let i = 0; i < scene.children.length; i++) {\r\n    const orb = scene.children[i];\r\n    if (orb.vId === vId) {\r\n      scene.remove(orb);\r\n    }\r\n  }\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nexport default function Volume({ changeVolume }) {\r\n  const canvasRef = useRef();\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const { width: w, height: h } = canvas;\r\n    ctx.rect(0, 0, w, h);\r\n    ctx.fillStyle = \"#00ffb1\";\r\n    ctx.fill();\r\n\r\n    let up = true;\r\n    canvas.onmousedown = (e) => {\r\n      up = false;\r\n    };\r\n\r\n    canvas.ontouchstart = () => (up = false);\r\n\r\n    const changeBar = (e) => {\r\n      if (!up) {\r\n        var rect = canvas.getBoundingClientRect();\r\n        const ctx = canvas.getContext(\"2d\");\r\n        const x = e.touches ? e.touches[0].clientX : e.clientX;\r\n        const coords = { x: x - rect.left };\r\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n        ctx.beginPath();\r\n        ctx.rect(0, 0, coords.x, h);\r\n        ctx.fill();\r\n        changeVolume(coords.x / ctx.canvas.width);\r\n      }\r\n    };\r\n\r\n    canvas.onmousemove = changeBar;\r\n    canvas.ontouchmove = changeBar;\r\n\r\n    document.onmouseup = () => (up = true);\r\n  }, [changeVolume]);\r\n\r\n  return (\r\n    <div id=\"volume\">\r\n      <canvas ref={canvasRef} />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { createOrb } from \"./ThreeFuncs\";\r\nimport Volume from \"./Volume\";\r\n\r\nfunction clamp(val, min, max) {\r\n  return val > max ? max : val < min ? min : val;\r\n}\r\n\r\nexport default function StreamControls({\r\n  videoRef,\r\n  isPlaying,\r\n  isMuted,\r\n  toggleMute,\r\n  setupAudioContext,\r\n}) {\r\n  const changeVolume = (volume) =>\r\n    (videoRef.current.volume = clamp(volume, 0, 1));\r\n\r\n  const togglePlay = () => {\r\n    const video = videoRef.current;\r\n    console.log(isPlaying);\r\n    if (isPlaying) {\r\n      video.pause();\r\n    } else {\r\n      video.play();\r\n    }\r\n  };\r\n\r\n  const goToLive = () => {\r\n    const video = videoRef.current;\r\n    video.currentTime = video.seekable.end(0);\r\n  };\r\n\r\n  return (\r\n    <div id=\"controls-container\">\r\n      <div onClick={goToLive}>Go To Live</div>\r\n      <div onClick={togglePlay}>{isPlaying ? \"Pause\" : \"Play\"}</div>\r\n      <div onClick={toggleMute}>{isMuted ? \"Unmute\" : \"Mute\"}</div>\r\n      <div onClick={createOrb}>Orb</div>\r\n      <div onClick={setupAudioContext}>AudioCtx</div>\r\n      {navigator.platform !== \"iPhone\" && (\r\n        <Volume changeVolume={changeVolume} />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useCallback, useEffect, useState } from \"react\";\r\nimport Hls from \"hls.js\";\r\nimport fire from \"./fire.mp4\";\r\nimport StreamControls from \"./StreamControls\";\r\nconst url = \"https://ice.raptor.pizza/hls/meiosis.m3u8\";\r\nconst MAX_RETRIES = 15;\r\nexport default function ArtistStream({\r\n  createScreen,\r\n  phase,\r\n  videoRef,\r\n  setupAudioContext,\r\n  test = false,\r\n}) {\r\n  const [loading, setLoading] = useState(!test);\r\n  const [retryCounter, setRetryCounter] = useState(0);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [isMuted, setIsMuted] = useState(true);\r\n\r\n  const initStream = useCallback(async () => {\r\n    const video = videoRef.current;\r\n    await fetch(url)\r\n      .then((r) => r)\r\n      .then((d) => {\r\n        if (d.status === 404) {\r\n          return false;\r\n        }\r\n        setLoading(false);\r\n        const source = url;\r\n        if (Hls.isSupported()) {\r\n          const hls = new Hls();\r\n          hls.loadSource(source);\r\n          hls.attachMedia(video);\r\n        } else {\r\n          video.src = source;\r\n        }\r\n      });\r\n  }, [videoRef]);\r\n\r\n  useEffect(() => {\r\n    initStream();\r\n  }, [initStream]);\r\n\r\n  const incrementCounter = useCallback(\r\n    () => setRetryCounter(retryCounter + 1),\r\n    [retryCounter]\r\n  );\r\n  useEffect(() => {\r\n    if (!loading) return;\r\n    if (retryCounter > MAX_RETRIES) {\r\n      setRetryCounter(0);\r\n      return initStream();\r\n    }\r\n    setTimeout(incrementCounter, 1000);\r\n  }, [initStream, incrementCounter, retryCounter, loading]);\r\n\r\n  useEffect(() => {\r\n    videoRef.current.src = fire;\r\n    createScreen(videoRef.current);\r\n    videoRef.current.onplay = () => setIsPlaying(true);\r\n    videoRef.current.onpause = () => setIsPlaying(false);\r\n    //  eslint-disable-next-line\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const video = videoRef.current;\r\n    if (isMuted) {\r\n      video.muted = true;\r\n    } else {\r\n      video.muted = false;\r\n    }\r\n  }, [isMuted, videoRef]);\r\n\r\n  const toggleMute = (e) => {\r\n    console.log(e);\r\n    setIsMuted(!isMuted);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <video\r\n        id=\"artist-stream\"\r\n        className=\"video-js\"\r\n        crossOrigin=\"true\"\r\n        ref={videoRef}\r\n        playsInline\r\n        autoPlay\r\n        loop\r\n        controls\r\n        muted\r\n      />\r\n      {/* {phase > 0 && ( */}\r\n      <StreamControls\r\n        videoRef={videoRef}\r\n        isPlaying={isPlaying}\r\n        isMuted={isMuted}\r\n        toggleMute={toggleMute}\r\n        setupAudioContext={setupAudioContext}\r\n      />\r\n      {/* )} */}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\n\r\nexport default function PressStart({ phase }) {\r\n  const [styles, setStyles] = useState();\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    const rect = ref.current.getBoundingClientRect();\r\n    setStyles({\r\n      marginLeft: -rect.width / 2 + \"px\",\r\n      marginTop: -rect.height / 2 + \"px\",\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      style={{ ...styles, opacity: phase === 1 ? 0 : 1 }}\r\n      id=\"press-start\"\r\n    >\r\n      Press\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport * as THREE from \"three\";\r\nimport { PointerLockControls } from \"three/examples/jsm/controls/PointerLockControls\";\r\nimport ArtistStream from \"./ArtistStream\";\r\nimport PressStart from \"./PressStart\";\r\nimport {\r\n  CAMERA_START,\r\n  collisionObjects,\r\n  createFloor,\r\n  createLight,\r\n  createOrb,\r\n  createScreen,\r\n  lerp,\r\n  mouse,\r\n  orbs,\r\n  ray,\r\n  scene,\r\n  startButton,\r\n  stats,\r\n} from \"./ThreeFuncs\";\r\n\r\nconst test = false;\r\nvar analyser;\r\nvar dataArray;\r\nexport default function ThreeWorld() {\r\n  const [phase, setPhase] = useState(0);\r\n  const worldContainerRef = useRef(undefined);\r\n  const videoRef = useRef(undefined);\r\n\r\n  useEffect(() => {\r\n    if (phase === 1) {\r\n    }\r\n  }, [phase]);\r\n\r\n  const setupAudioContext = () => {\r\n    if (navigator.platform === \"iPhone\") return;\r\n    var audioCtx = new (window.AudioContext || window.webkitAudioContext)();\r\n    analyser = audioCtx.createAnalyser();\r\n    var source = audioCtx.createMediaElementSource(videoRef.current);\r\n    source.connect(analyser);\r\n    source.connect(audioCtx.destination);\r\n    analyser.fftSize = 512;\r\n    var bufferLength = analyser.frequencyBinCount;\r\n    dataArray = new Uint8Array(bufferLength);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (worldContainerRef.current === undefined) return;\r\n    const camera = new THREE.PerspectiveCamera(\r\n      75,\r\n      window.innerWidth / window.innerHeight,\r\n      0.1,\r\n      1000\r\n    );\r\n    const { x, y, z } = CAMERA_START;\r\n    camera.position.set(x, y, z);\r\n    camera.lookAt(0, 0, 0);\r\n    var controls;\r\n    // CONTROLS\r\n    // ORBIT\r\n    // const controls = new OrbitControls(camera, worldContainerRef.current);\r\n    // controls.maxPolarAngle = Math.PI / 2;\r\n    // POINTER\r\n    var moveForward = false,\r\n      moveBackward = false,\r\n      moveLeft = false,\r\n      moveRight = false;\r\n    const velocity = new THREE.Vector3();\r\n    const direction = new THREE.Vector3();\r\n    const setupPointerControls = () => {\r\n      controls = new PointerLockControls(camera, worldContainerRef.current);\r\n      worldContainerRef.current.addEventListener(\"click\", () =>\r\n        controls.lock()\r\n      );\r\n      scene.add(controls.getObject());\r\n\r\n      function onKeyDown(e) {\r\n        switch (e.key) {\r\n          case \"w\":\r\n            moveForward = true;\r\n            break;\r\n          case \"a\":\r\n            moveLeft = true;\r\n            break;\r\n          case \"s\":\r\n            moveBackward = true;\r\n            break;\r\n          case \"d\":\r\n            moveRight = true;\r\n            break;\r\n          case \" \":\r\n            if (canJump) velocity.y += 200;\r\n            canJump = false;\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n      function onKeyUp(e) {\r\n        switch (e.key) {\r\n          case \"w\":\r\n            moveForward = false;\r\n            break;\r\n          case \"a\":\r\n            moveLeft = false;\r\n            break;\r\n          case \"s\":\r\n            moveBackward = false;\r\n            break;\r\n          case \"d\":\r\n            moveRight = false;\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n\r\n      document.addEventListener(\"keydown\", onKeyDown, false);\r\n      document.addEventListener(\"keyup\", onKeyUp, false);\r\n    };\r\n\r\n    // END OF CONTROLS SETUP\r\n\r\n    const renderer = new THREE.WebGLRenderer();\r\n    renderer.setClearColor(new THREE.Color(1.0, 1.0, 1.0));\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.setPixelRatio(window.devicePixelRatio);\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n    worldContainerRef.current.appendChild(renderer.domElement);\r\n    // worldContainerRef.current.appendChild(stats.dom);\r\n    const startButtonObject = startButton();\r\n    createFloor();\r\n    createLight();\r\n\r\n    function mouseVector(e) {\r\n      const coords = { x: 0, y: 0 };\r\n      if (e instanceof TouchEvent) {\r\n        coords.x = e.touches[0].clientX;\r\n        coords.y = e.touches[0].clientY;\r\n      } else {\r\n        coords.x = e.clientX;\r\n        coords.y = e.clientY;\r\n      }\r\n      mouse.x = (coords.x / window.innerWidth) * 2 - 1;\r\n      mouse.y = -(coords.y / window.innerHeight) * 2 + 1;\r\n    }\r\n\r\n    worldContainerRef.current.addEventListener(\"touchstart\", checkClick, true);\r\n    worldContainerRef.current.addEventListener(\"click\", checkClick, true);\r\n\r\n    var started = false;\r\n    var clickAnimationRunning = false;\r\n    function checkClick(e) {\r\n      mouseVector(e);\r\n      ray.setFromCamera(mouse, camera);\r\n      const intersections = ray.intersectObjects([startButtonObject]);\r\n      if (intersections.length > 0) {\r\n        // controls.autoRotate = true;\r\n        // setupAudioContext();\r\n        videoRef.current.play();\r\n        if (!clickAnimationRunning) {\r\n          clickAnimationRunning = true;\r\n          const start = performance.now();\r\n          const currentColor = startButtonObject.material.color;\r\n          var frame;\r\n          const buttonAnimation = () => {\r\n            const now = (performance.now() - start) * 0.001;\r\n\r\n            startButtonObject.material.color.set(\r\n              currentColor.lerp(new THREE.Color(0, 0, 1), now)\r\n            );\r\n\r\n            startButtonObject.material.opacity = lerp(now - 1, 1, 0);\r\n\r\n            setPhase(1);\r\n            if (now > 2) {\r\n              started = true;\r\n              setupPointerControls();\r\n              try {\r\n                controls.lock();\r\n                controls.isLocked = true;\r\n              } catch (err) {\r\n                // Simulate pointer lock to start falling\r\n                controls.isLocked = true;\r\n              }\r\n\r\n              createOrb({ n: 1000 });\r\n\r\n              return cancelAnimationFrame(frame);\r\n            }\r\n            frame = requestAnimationFrame(buttonAnimation);\r\n          };\r\n          buttonAnimation();\r\n        }\r\n      }\r\n      worldContainerRef.current.removeEventListener(\r\n        \"touchstart\",\r\n        checkClick,\r\n        true\r\n      );\r\n      worldContainerRef.current.removeEventListener(\"click\", checkClick, true);\r\n    }\r\n\r\n    document.addEventListener(\"touchstart\", handleTouchStart, false);\r\n    document.addEventListener(\"touchend\", handleTouchEnd, false);\r\n    document.addEventListener(\"touchmove\", handleTouchMove, false);\r\n\r\n    var xDown = null;\r\n    var yDown = null;\r\n\r\n    function getTouches(evt) {\r\n      return (\r\n        evt.touches || // browser API\r\n        evt.originalEvent.touches\r\n      ); // jQuery\r\n    }\r\n\r\n    const rotateStart = new THREE.Vector2();\r\n    function handleTouchStart(evt) {\r\n      const firstTouch = getTouches(evt)[0];\r\n      xDown = firstTouch.clientX;\r\n      yDown = firstTouch.clientY;\r\n      rotateStart.set(evt.touches[0].clientX, evt.touches[0].clientY);\r\n    }\r\n\r\n    const rotateEnd = new THREE.Vector2();\r\n    const rotateDelta = new THREE.Vector2();\r\n    var phi = 0;\r\n    var theta = (1 * Math.PI) / 180;\r\n    function handleTouchMove(evt) {\r\n      if (!started) return;\r\n      // evt.preventDefault();\r\n      rotateEnd.set(evt.touches[0].clientX, evt.touches[0].clientY);\r\n      rotateDelta.subVectors(rotateEnd, rotateStart);\r\n      rotateStart.copy(rotateEnd);\r\n      phi =\r\n        phi +\r\n        ((2 * Math.PI * rotateDelta.y) / renderer.domElement.height) * 0.3;\r\n      theta +=\r\n        ((2 * Math.PI * rotateDelta.x) / renderer.domElement.width) * 0.5;\r\n      if (!xDown || !yDown) {\r\n        return;\r\n      }\r\n      var xUp = evt.touches[0].clientX;\r\n      var yUp = evt.touches[0].clientY;\r\n      var xDiff = xDown - xUp;\r\n      var yDiff = yDown - yUp;\r\n\r\n      if (Math.abs(xDiff) > Math.abs(yDiff)) {\r\n        /*most significant*/\r\n        if (xDiff > 0) {\r\n          /* left swipe */\r\n          // look(evt);\r\n        } else {\r\n          /* right swipe */\r\n          // look(evt);\r\n        }\r\n      } else {\r\n        if (yDiff > 0) {\r\n          /* up swipe */\r\n          moveBackward = true;\r\n        } else {\r\n          /* down swipe */\r\n          moveForward = true;\r\n        }\r\n      }\r\n      /* reset values */\r\n      xDown = null;\r\n      yDown = null;\r\n    }\r\n\r\n    function handleTouchEnd(evt) {\r\n      moveForward = false;\r\n      moveBackward = false;\r\n    }\r\n\r\n    var scope = {};\r\n    scope.minPolarAngle = 0;\r\n    scope.maxPolarAngle = Math.PI;\r\n    var euler = new THREE.Euler(0, 0, 0, \"YXZ\");\r\n\r\n    const bbox = new THREE.Box3();\r\n    let frame;\r\n    var canJump = true;\r\n    var prevTime;\r\n    var orientation = new THREE.Quaternion();\r\n    var previousPhi;\r\n    var previousTheta;\r\n    function animate() {\r\n      frame = requestAnimationFrame(animate);\r\n\r\n      if (phi === previousPhi && theta === previousTheta) {\r\n      } else if (started) {\r\n        previousPhi = phi;\r\n        previousTheta = theta;\r\n        euler.set(phi, theta, 0, \"YXZ\");\r\n        orientation.setFromEuler(euler);\r\n        camera.quaternion.copy(orientation);\r\n      }\r\n\r\n      // camera.position.x = radius * Math.cos(angle);\r\n      // camera.position.z = radius * Math.sin(angle);\r\n      // POINTER CONTROLS MOVEMENTS\r\n      const time = performance.now();\r\n      if (controls && controls.isLocked) {\r\n        direction.z = Number(moveForward) - Number(moveBackward);\r\n        direction.x = Number(moveRight) - Number(moveLeft);\r\n        direction.normalize(); // this ensures consistent movements in all directions\r\n\r\n        const delta = (time - prevTime) / 1000;\r\n        velocity.x -= velocity.x * 10.0 * delta;\r\n        velocity.z -= velocity.z * 10.0 * delta;\r\n\r\n        // find intersections\r\n        const controlObject = controls.getObject();\r\n        const oldPosition = new THREE.Vector3();\r\n        oldPosition.copy(controlObject.position);\r\n\r\n        velocity.y -= 9.8 * 100.0 * delta; // 100.0 = mass\r\n\r\n        if (moveForward || moveBackward)\r\n          velocity.z -= direction.z * 400.0 * delta;\r\n        if (moveLeft || moveRight) velocity.x -= direction.x * 400.0 * delta;\r\n\r\n        controls.moveRight(-velocity.x * delta);\r\n        controls.moveForward(-velocity.z * delta);\r\n\r\n        const sphere = new THREE.Sphere(controlObject.position, 2);\r\n\r\n        // intersection\r\n        if (collisionObjects.length > 0) {\r\n          const object = collisionObjects[0];\r\n          object.geometry.computeBoundingBox();\r\n          bbox\r\n            .copy(object.geometry.boundingBox)\r\n            .applyMatrix4(object.matrixWorld);\r\n          const intersections = sphere.intersectsBox(bbox);\r\n          if (intersections) {\r\n            velocity.y = Math.max(0, velocity.y);\r\n            if (controls.getObject().position.y === 0)\r\n              controlObject.position.copy(oldPosition);\r\n            canJump = true;\r\n          }\r\n        }\r\n        controls.getObject().position.y += velocity.y * delta; // new behavior\r\n        if (controls.getObject().position.y < 0) {\r\n          velocity.y = 0;\r\n          controls.getObject().position.y = 0;\r\n\r\n          canJump = true;\r\n        }\r\n      }\r\n      prevTime = time;\r\n\r\n      // END OF POINTER CONTROLS MOVEMENTS\r\n\r\n      if (analyser) {\r\n        analyser.getByteFrequencyData(dataArray);\r\n      }\r\n      for (let i = 0; i < orbs.length; i++) {\r\n        orbs[i].rotation.y += 0.01;\r\n        const wave = Math.sin(time * 0.001 + i);\r\n        orbs[i].scale.set(wave, wave, wave);\r\n        if (analyser) {\r\n          const d = dataArray[i % 256] / 100;\r\n          orbs[i].scale.set(d, d, d);\r\n        }\r\n      }\r\n\r\n      renderer.render(scene, camera);\r\n      stats.update();\r\n      //controls.update();\r\n    }\r\n    animate();\r\n\r\n    const onWindowResize = () => {\r\n      camera.aspect = window.innerWidth / window.innerHeight;\r\n      camera.updateProjectionMatrix();\r\n      renderer.setSize(window.innerWidth, window.innerHeight);\r\n    };\r\n\r\n    window.addEventListener(\"resize\", onWindowResize, false);\r\n\r\n    return () => {\r\n      cancelAnimationFrame(frame);\r\n      window.removeEventListener(\"resize\", onWindowResize, false);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div style={{ width: \"100%\", height: \"100%\" }} ref={worldContainerRef}>\r\n      <PressStart phase={phase} />\r\n      <ArtistStream\r\n        createScreen={createScreen}\r\n        phase={phase}\r\n        videoRef={videoRef}\r\n        test={test}\r\n        setupAudioContext={setupAudioContext}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport \"./index.scss\";\nimport ThreeWorld from \"./ThreeWorld\";\n\nexport default function App() {\n  return (\n    <div>\n      <ThreeWorld />\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}